<?phpclass EnterpriseWS{var $endpoint;var $channel;var $header;var $envelope;var $username;var $password;var $host;	function __construct()	{		$this->host = "http://sgsm-dev.edgtechnology.com.br";		$this->setEndpoint();		$this->setChannel();    }	function EnterpriseWS()	{		$this->setEndpoint();		$this->setChannel();	}	function setEnterpriseWSUser($user, $pass)	{		$this->username = $user;		$this->password = $pass;	}	function setEndpoint()	{		$this->endpoint = $this->host ."/ws/WsVendaMicroSeguro.asmx";	}	/*	function setEndpointUrl($urlParam)	{		$this->endpoint = $urlParam;		$this->setChannel();	}*/		function setEndpointVenda()	{		$this->endpoint = $this->host ."/ws/WsVendaMicroSeguro.asmx";		$this->setChannel();	}		function setEndpointParceiro()	{		$this->endpoint = $this->host ."/ws/WsParceiroMicroSeguro.asmx";		$this->setChannel();	}		function setEndpointCliente()	{		$this->endpoint = $this->host ."/ws/WsClienteMicroSeguro.asmx";		$this->setChannel();	}	function setChannel()	{		$this->channel = @curl_init();		/*		curl_setopt($this->channel, CURLOPT_SSL_VERIFYPEER, 0);		curl_setopt($this->channel, CURLOPT_URL, $this->endpoint);		curl_setopt($this->channel, CURLOPT_RETURNTRANSFER, true);		curl_setopt($this->channel, CURLOPT_HTTPAUTH, CURLAUTH_ANY);		curl_setopt($this->channel, CURLOPT_TIMEOUT, 120);		curl_setopt($this->channel, CURLOPT_POST, true);		//curl_setopt($this->channel, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4 );		curl_setopt($this->channel, CURLOPT_SSL_VERIFYPEER, FALSE);		curl_setopt($this->channel, CURLOPT_SSL_VERIFYHOST, FALSE);		*/		$options = array(			CURLOPT_SSL_VERIFYPEER => 0			, CURLOPT_URL => $this->endpoint			, CURLOPT_RETURNTRANSFER => true			, CURLOPT_HTTPAUTH => CURLAUTH_ANY			, CURLOPT_TIMEOUT => 120			, CURLOPT_POST => true			, CURLOPT_SSL_VERIFYPEER => false			, CURLOPT_SSL_VERIFYHOST => false		);		curl_setopt_array($this->channel, $options);	}	function setSegurancaHeader()	{		$user = $this->username;		$pass = $this->password;		$this->header = "<sgsm:SegurancaService>			 <sgsm:UserName>$user</sgsm:UserName>			 <sgsm:Password>$pass</sgsm:Password>		  </sgsm:SegurancaService>";	}	function EnviaSolicitacao($xml_post_string, $servico)	{		$headers = array(			"Content-type: text/xml;charset=\"utf-8\"",			"Accept: text/xml",			"Cache-Control: no-cache",			"Pragma: no-cache",			"SOAPAction: http://sgsm.enterpriseseguros.com.br/".$servico		);		curl_setopt($this->channel, CURLOPT_HTTPHEADER, $headers);		curl_setopt($this->channel, CURLOPT_POSTFIELDS, $xml_post_string); 		$response = curl_exec($this->channel); 		if( curl_errno( $this->channel ) == CURLE_OK ) {			// echo "Connected<br><br>";		} else {			// echo "Not Connected<br><br>";		}		curl_close($this->channel);		//return simplexml_load_string($response);		return ($response);	}	function MontaEnvelope($body)	{		$str = '<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sgsm="http://sgsm.enterpriseseguros.com.br">';		if($this->header!="")		{			$str .= '<soapenv:Header>';			$str .= $this->header;			$str .= '</soapenv:Header>';		}		$str .= '<soapenv:Body>';		$str .= $body;		$str .= '</soapenv:Body>';		$str .= '</soapenv:Envelope>';		//var_dump($str);exit;		return $str;	}	function ListaEventosNOSHOW($body)	{		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "ListaEventos");	}		function ListaUFsNOSHOW($body)	{		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "ListUFs");	}	function VendaMicroSeguroNOSHOW($body)	{		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "RealizaVenda");	}	function SendCertificadoByEmailNOSHOW($body)	{		$this->setEndpointCliente();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "SendCertificadoByEmail");	}	function GetCertificadoPDFNOSHOW($body)	{		$this->setEndpointCliente();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetCertificadoPDF");	}	function ValidaParceiroNOSHOW($body)	{		$this->setEndpointParceiro();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "ValidaUsuarioParceiro");	}	function GetClienteCadastroNOSHOW($body)	{		$this->setEndpointCliente();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetClienteCadastro");	}	function GetTiposIngressoByIDEventoNOSHOW($body)	{		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetTiposIngressoByIDEvento");	}		function GetCertificadosByEmpresaNOSHOW($body)	{		$this->setEndpointParceiro();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetCertificadosByEmpresa");	}		function ListaEventosByOperadoraNOSHOW($body)	{		$this->setEndpointParceiro();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "ListaEventosByOperadora");	}		function GetCertificadosPendentesNOSHOW($body)	{		$this->setEndpointParceiro();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetCertificadosPendentes");	}		function GetBoasVindasPDFByCertificadoNOSHOW($body)	{		$this->setEndpointCliente();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetBoasVindasPDFByCertificado");	}		function GetComunicacaoVendaDiretaNOSHOW($body)	{		$this->setEndpointParceiro();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "GetComunicacaoVendaDireta");	}		function CadastroClienteContatoNOSHOW($body)	{		$this->setEndpointCliente();		$this->setSegurancaHeader();		return $this->EnviaSolicitacao($this->MontaEnvelope($body), "CadastroClienteContato");	}}?>